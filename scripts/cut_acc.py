# time,pid,x,y,z
# 0,JB3156,0.0,0.0,0.0
# 0,CC6740,0.0,0.0,0.0
# 1493733882409,SA0297,0.0758,0.0273,-0.0102
# 1493733882455,SA0297,-0.0359,0.0794,0.0037
# 1493733882500,SA0297,-0.2427,-0.0861,-0.0163
# 1493733883945,SA0297,-0.2888,0.0514,-0.0145
# 1493733883953,SA0297,-0.0413,-0.0184,-0.0105
# 1493733883957,SA0297,-0.0413,-0.0001,0.0017
# 1493733883963,SA0297,-0.0286,-0.0028,-0.0094
# 1493733883974,SA0297,-0.0543,-0.041,-0.0109
# 1493733883977,SA0297,0.006999999999999999,-0.005,-0.0849
# 1493733883991,SA0297,-0.0561,-0.0226,0.0134-0.0002,-0.0001
# 1493745542825,BK7610,-0.01,-0.106,0.4448
# 1493745542833,DK3500,0.014,0.0884,-0.0841
# 1493745542835,BU4707,-0.036000000000000004,-0.0731,-0.1349
# 1493745542835,CC6740,7.238984e-05,-0.00840342,0.15003204
# 1493745542837,JB3156,1.1887212,-180900768.0,180900752.0
# 1493745542841,SF3079,0.0206,0.046,-0.0715
# 1493745542849,MJ8002,0.0026,-0.0014,-0.0007
# 1493745542849,BK7610,-0.4111,-0.5598,0.5512
# 1493745542857,JB3156,2.835932,-180900768.0,180900752.0
# 1493745542857,DK3500,-0.0012,0.0878,-0.0989
# 1493745542860,BU4707,-0.1534,-0.022,-0.1518
# 1493745542863,CC6740,-0.037730224,0.029138476,0.11175156
# 1493745542872,SF3079,0.0226,0.0527,-0.0795
# 1493745542873,MJ8002,0.0035,-0.0004,0.0004
# 1493745542875,BK7610,-0.7002,-0.6631,0.7588
# 1493745542877,JB3156,1.3239936,-180900768.0,180900752.0
# 1493745542883,DK3500,0.0231,0.0942,-0.0495
# 1493745542885,BU4707,-0.1714,-0.005,-0.1586
# 1493745542887,CC6740,0.02006946,0.04805112,0.13091278
# 1493745542893,SF3079,0.0119,0.0791,-0.1043
# 1493745542897,JB3156,2.4109612,-180900768.0,180900752.0
# 1493745542899,MJ8002,0.0042,-0.0007,0.0016
# 1493745542900,BK7610,-0.7148,-0.5344,0.5672
import csv
import os
from pathlib import Path
from sysconfig import get_path

with open('all_accelerometer_data_pids_13.csv') as data_csv:
    os.chmod(os.getcwd(), 0o777)
    Path('pid_accelerometer/').mkdir(mode = 0o777, parents=True, exist_ok=True)
    csv_reader = csv.reader(data_csv, delimiter=',')
    line_count = 0
    pid = ''
    columns = ''
    for row in csv_reader:
        if line_count == 0:
            columns = row
            line_count +=1
        else:
            with open('pid_accelerometer/accelerometer_'+str(row[1])+'.csv', 'a+') as pid_acc:
                writer = csv.writer(pid_acc, delimiter=',')
                writer.writerow([row[0], row[1], row[2], row[3], row[4]])
                #write in pid.csv
